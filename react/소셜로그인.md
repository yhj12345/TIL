## ì†Œì…œë¡œê·¸ì¸

![image-20220913225806567](C:\Users\SSAFY\Desktop\HJ\TIL\react\assets\image-20220913225806567.png)

### ğŸ§©ë„¤ì´ë²„

#### âœ”1ë‹¨ê³„ 

```html
// index.html
// script ì½”ë“œ, public í´ë” ì•ˆì˜ index.html íŒŒì¼ ì† head ë¶€ë¶„ì— ì•„ë˜ ì½”ë“œë¥¼ ì¶”ê°€  

<script type="text/javascript" 										          
        src="https://static.nid.naver.com/js/naveridlogin_js_sdk_2.0.0.js"
        charset="utf-8">
</script>
```



#### âœ”2ë‹¨ê³„

```react
// êµ¬í˜„ ì½”ë“œ
import React, { useEffect } from 'react';
import { useRef } from 'react';
import styled from 'styled-components';

// ë„¤ì´ë²„ì—ì„œ ì œê³µí•´ì£¼ëŠ” naverIdLoginì˜ cssë¥¼ display: noneìœ¼ë¡œ ì„¤ì •í•´ì¤€ ë’¤
// ì»¤ìŠ¤í…€í•œ ë²„íŠ¼ì„ ë§Œë“¤ì–´ ì¤€ ë’¤
// useRefë¡œ ì„¤ì •ëœ ë²„íŠ¼ì„ ì—°ê²°í•´ì¤€ë‹¤.
const Wrapper = styled.div`
  #naverIdLogin {
    display: none;
  }

  .naver {
    padding: 0.6em 1em;
    border-radius: 0.25em;
    border: none;
    font-size: 1rem;
    margin-top: 0.7em;
    display: flex;
    width: 60%;
    height: 3rem;
    justify-content: center;
    align-items: center;
    font-weight: 400;
    box-shadow: var(--shadow-1);
    background-color: #03c75a;
    color: white;
    margin: 0 auto;
    cursor: pointer;
  }
  .naverlogo {
    height: 2.5rem;
    width: auto;
  }
`;

const NaverLogin = () => {
  const { naver } = window;
  // ë„¤ì´ë²„ì— ì• í”Œë¦¬ì¼€ì´ì…˜ì— Idì™€ CallbackUrlì„ ê°€ì ¸ì˜´ 
  const NAVER_CLIENT_ID = 'nD3LMlh8XVw9Vkf10kQL';
  const NAVER_CALLBACK_URL = 'http://localhost:3000/user/login';
  
  // ë„¤ì´ë²„ ë¡œê·¸ì¸ ë²„íŠ¼ ë§Œë“¤ê¸°
  const initializeNaverLogin = () => {
    const naverLogin = new naver.LoginWithNaverId({
      clientId: NAVER_CLIENT_ID,
      callbackUrl: NAVER_CALLBACK_URL,
      isPopup: false,
      loginButton: { color: 'green', type: 3, height: 58 },
      callbackHandle: true,
    });
    naverLogin.init();
  };

  useEffect(() => {
    initializeNaverLogin();
  }, []);

  const naverRef = useRef();

  const handleClick = () => {
    naverRef.current.children[0].click();
  };

  return (
    <Wrapper>
      <div ref={naverRef} id="naverIdLogin" />
      <button onClick={handleClick} className="naver">
        <img src="/img/naver.png" alt="naver" className="naverlogo" />
        Login with Naver
      </button>
    </Wrapper>
  );
};

export default NaverLogin;
```



#### âœ”3ë‹¨ê³„

```react
import React, { useEffect } from 'react';
import { useRef } from 'react';
import { useDispatch } from 'react-redux';
import { useLocation, useNavigate } from 'react-router-dom';
import styled from 'styled-components';
import {
  fetchUserInfo,
  userLoginNaver,
} from '../../../features/user/userActions';

const Wrapper = styled.div`
  #naverIdLogin {
    display: none;
  }

  .naver {
    padding: 0.6em 1em;
    border-radius: 0.25em;
    border: none;
    font-size: 1rem;
    margin-top: 0.7em;
    display: flex;
    width: 60%;
    height: 3rem;
    justify-content: center;
    align-items: center;
    font-weight: 400;
    box-shadow: var(--shadow-1);
    background-color: #03c75a;
    color: white;
    margin: 0 auto;
    cursor: pointer;
  }
  .naverlogo {
    height: 2.5rem;
    width: auto;
  }
`;

const NaverLogin = () => {
  const { naver } = window;
  const naverRef = useRef();
  const location = useLocation();
  const dispatch = useDispatch();
  const navigate = useNavigate();

  const NAVER_CLIENT_ID = 'nD3LMlh8XVw9Vkf10kQL';
  const NAVER_CALLBACK_URL = 'http://localhost:3000/user/login';

  const initializeNaverLogin = () => {
    const naverLogin = new naver.LoginWithNaverId({
      clientId: NAVER_CLIENT_ID,
      callbackUrl: NAVER_CALLBACK_URL,
      isPopup: false,
      loginButton: { color: 'green', type: 3, height: 58 },
      callbackHandle: true,
    });
    naverLogin.init();
  };
  
  // ìœ„ì—ì„œ ë§Œë“  ë²„íŠ¼ìœ¼ë¡œ ë„¤ì´ë²„ í˜ì´ì§€ë¡œ ì´ë™í•œ í›„ ë„¤ì´ë²„ ë¡œê·¸ì¸ì„ ì§„í–‰í•˜ë©´
  // callbackUrl ë’¤ì— ì•¡ì„¸ìŠ¤ í† í°ê³¼ íƒ€ì…, ê¸°ê°„ ë“±ì˜ ì •ë³´ë¥¼ ë¶™ì—¬ì„œ ì£¼ê¸° ë•Œë¬¸ì—
  // url ë’¤ì˜ ì•¡ì„¸ìŠ¤ í† í°ì„ íŒŒì‹±í•œ í›„ ë°±ì—”ë“œë¡œ ë³´ë‚´ê³  ë°±ì—”ë“œì—ì„œ ìš°ë¦¬ë§Œì˜ ì•¡ì„¸ìŠ¤í† í°ì„ ë‹¤ì‹œ ë°œê¸‰ ë°›ì€ í›„
  // ìš°ë¦¬ ì•¡ì„¸ìŠ¤ í† í°ìœ¼ë¡œ ì‚¬ìš©ì ì •ë³´ë¥¼ ë°›ì•„ì˜¤ê³  ë¡œê·¸ì¸ ì™„ë£Œ í›„ ë©”ì¸í˜ì´ì§€ë¡œ ì´ë™
  const getNaverToken = () => {
    if (!location.hash) return;
    const token = location.hash.split('=')[1].split('&')[0];
    dispatch(userLoginNaver(token));
    dispatch(fetchUserInfo());
    navigate('/');
  };

  useEffect(() => {
    initializeNaverLogin();
    getNaverToken();
  }, []);

  const handleClick = () => {
    naverRef.current.children[0].click();
  };

  return (
    <Wrapper>
      <div ref={naverRef} id="naverIdLogin" />
      <button onClick={handleClick} className="naver">
        <img src="/img/naver.png" alt="naver" className="naverlogo" />
        Login with Naver
      </button>
    </Wrapper>
  );
};

export default NaverLogin;

```

